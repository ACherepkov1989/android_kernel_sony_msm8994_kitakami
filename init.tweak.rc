# Custom Init Script

on boot
    # Enable Fingerprint boost
    write /sys/kernel/fp_boost/enabled 1

    # Change the compression algorithm for zRAM
    write /sys/block/zram0/comp_algorithm lz4
    # Set the maximum number of streams for zRAM
    write /sys/block/zram0/max_comp_streams 5

    # Set 512 KB for internal memory read-cache
    write /sys/block/mmcblk0/queue/read_ahead_kb 512
    # Set 1024 KB for external memory read-cache
    write /sys/block/mmcblk1/queue/read_ahead_kb 1024

    # Set I/O Scheduler tweaks
    write /sys/block/mmcblk0/queue/scheduler maple
    write /sys/block/mmcblk0/queue/iosched/writes_starved 4
    write /sys/block/mmcblk0/queue/iosched/fifo_batch 16
    write /sys/block/mmcblk0/queue/iosched/sync_read_expire 350
    write /sys/block/mmcblk0/queue/iosched/sync_write_expire 550
    write /sys/block/mmcblk0/queue/iosched/async_read_expire 250
    write /sys/block/mmcblk0/queue/iosched/async_write_expire 450
    write /sys/block/mmcblk0/queue/iosched/sleep_latency_multiple 10

    # Enable core control with custom config
    # A53
    write /sys/devices/system/cpu/cpu0/core_ctl/always_online_cpu "1 1 1 1"
    # A57
    write /sys/devices/system/cpu/cpu4/core_ctl/max_cpus 4
    write /sys/devices/system/cpu/cpu4/core_ctl/min_cpus 1
    write /sys/devices/system/cpu/cpu4/core_ctl/is_big_cluster 1
    write /sys/devices/system/cpu/cpu4/core_ctl/task_thres 4
    write /sys/devices/system/cpu/cpu4/core_ctl/always_online_cpu "1 0 0 0"
    write /sys/devices/system/cpu/cpu4/core_ctl/busy_down_thres "40"
    write /sys/devices/system/cpu/cpu4/core_ctl/busy_up_thres "68"
    chown system system /sys/devices/system/cpu/cpu4/core_ctl/min_cpus
    chown system system /sys/devices/system/cpu/cpu4/core_ctl/max_cpus

    # Max default frequencies
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq 1651200
    write /sys/devices/system/cpu/cpu4/cpufreq/scaling_max_freq 2016000

    # Table of CPU voltages
    write /sys/devices/system/cpu/cpu0/cpufreq/UV_mV_table "735 745 765 795 825 845 865 945 975 995 1005 1015 745 755 755 825 845 865 895 905 915 925 940 955 965 980 995"

    # KCAL default
    write /sys/devices/platform/kcal_ctrl.0/kcal "256 256 256"

    # Hi-Performance DAC Enabler (Maximize Sound Quality)
    #write /sys/module/snd_soc_wcd9330/parameters/high_perf_mode 1
